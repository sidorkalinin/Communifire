{"version":3,"sources":["../../src/pages/spaces/manage-user/manage-user.module.ts","../../src/pages/spaces/manage-user/manage-user.ts"],"names":[],"mappings":"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","file":"30.js","sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { IonicPageModule } from 'ionic-angular';\r\nimport { ManageUserPage } from './manage-user';\r\nimport { ComponentsModule } from '../../../components/components.module';\r\nimport { TranslateModule } from '@ngx-translate/core';\r\nimport { PipesModule } from '../../../pipes/pipes.modules';\r\nimport { PeopleProvider } from '../../../providers/people';\r\nimport { SpacesProvider } from '../../../providers/spaces';\r\nimport { AppCenterAnalytics } from '@ionic-native/app-center-analytics';\r\n\r\n@NgModule({\r\n  declarations: [\r\n    ManageUserPage,\r\n  ],\r\n  imports: [\r\n    IonicPageModule.forChild(ManageUserPage),\r\n    ComponentsModule,\r\n    TranslateModule,\r\n    PipesModule\r\n  ],\r\n  providers: [\r\n    PeopleProvider,\r\n    SpacesProvider,\r\n    AppCenterAnalytics\r\n  ]\r\n})\r\nexport class ManageUserPageModule {}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/spaces/manage-user/manage-user.module.ts","import { Component, OnInit } from '@angular/core';\r\nimport { IonicPage, ViewController, NavParams, InfiniteScroll, NavController, Refresher, ToastController, LoadingController } from 'ionic-angular';\r\nimport 'rxjs/add/operator/finally';\r\nimport 'rxjs/add/operator/do';\r\n\r\nimport { SpacesProvider } from '../../../providers/spaces';\r\nimport { AppCenterAnalytics } from '@ionic-native/app-center-analytics';\r\nimport { TranslateService } from '@ngx-translate/core';\r\n\r\n/**\r\n * Generated class for the ManageUserPage page.\r\n *\r\n * See https://ionicframework.com/docs/components/#navigation for more info on\r\n * Ionic pages and navigation.\r\n */\r\n@IonicPage({\r\n  name: 'manage-user',\r\n})\r\n@Component({\r\n  selector: 'page-manage-user',\r\n  templateUrl: 'manage-user.html',\r\n})\r\nexport class ManageUserPage {\r\n  spaceId = this.navParams.get('id');\r\n  communityUrl = localStorage.getItem('community_url');\r\n  isLoading: boolean = false;\r\n  isLoadingUsers: boolean = false;\r\n  isLoadingRequests: boolean = false;\r\n  spaceView: number = 0;\r\n  searchtext = '';\r\n  space;\r\n  spaceUsers = [];\r\n  spaceRequests = [];\r\n  spaceRequestUsers = [];\r\n  private peoplePage = 1;\r\n  private requestPage = 1;\r\n\r\n  buttons = [    \r\n    {\r\n      icon: 'ios-contact',\r\n      text: 'EXTRA.REQUEST'\r\n    }, {\r\n      icon: 'ios-people',\r\n      text: 'PEOPLE.HEADING'\r\n    }\r\n  ];\r\n\r\n  constructor(\r\n    public viewCtrl: ViewController,\r\n    public navParams: NavParams,\r\n    private spacesProvider: SpacesProvider,\r\n    private navCtrl: NavController,\r\n    private appCenterAnalytics: AppCenterAnalytics,\r\n    public translate: TranslateService,\r\n    private toastCtrl: ToastController,\r\n    public loadingCtrl: LoadingController,\r\n  ) {\r\n  }\r\n\r\n  ionViewDidLoad() {\r\n    console.log('ionViewDidLoad ManageUserPage');\r\n    this.getSpaceRequests();\r\n  }\r\n\r\n  switchSpaceView(view) {\r\n    this.spaceView = view.index;\r\n\r\n    if (this.spaceView === 0) {\r\n      this.getSpaceRequests();\r\n    } else if (this.spaceView === 1 && !this.spaceUsers.length) {\r\n      this.getSpaceUsers();\r\n    }\r\n  }\r\n\r\n  getSpaceRequests(infiniteScroll?: InfiniteScroll) {\r\n    if (infiniteScroll) {\r\n      ++this.requestPage;\r\n    }\r\n    if(!infiniteScroll && this.spaceRequestUsers.length > 0) {\r\n      return;\r\n    }\r\n    if (infiniteScroll && this.spaceRequestUsers.length > 0 && this.spaceRequestUsers.length < 15) {\r\n      infiniteScroll.enable(false);\r\n      return;\r\n    }\r\n\r\n\r\n    // Fetch Space user by Id\r\n    this.isLoadingRequests = true;\r\n    this.spacesProvider.getSpaceRequests(this.spaceId, this.requestPage, 15)\r\n      .finally(() => {\r\n        if (!infiniteScroll) {\r\n          this.isLoadingRequests = false\r\n        }\r\n        if (infiniteScroll) {\r\n          infiniteScroll.complete();\r\n        }\r\n      })\r\n      .do(response => {\r\n        if (infiniteScroll && !response.ResponseData.length) {\r\n          infiniteScroll.enable(false);\r\n        }\r\n      })\r\n      .subscribe(res => {\r\n        console.log(res.ResponseData);\r\n        if(res.ResponseData && res.ResponseData.length > 0) {\r\n          this.spaceRequestUsers = this.spaceRequestUsers.concat(res.ResponseData);\r\n        }        \r\n      });\r\n  }\r\n\r\n  getSpaceUsers(infiniteScroll?: InfiniteScroll) {\r\n    if (infiniteScroll) {\r\n      ++this.peoplePage;\r\n    }\r\n    if(!infiniteScroll && this.spaceUsers.length > 0) {\r\n      return;\r\n    }\r\n    if (this.spaceUsers.length > 0 && this.spaceUsers.length < 15) {\r\n      infiniteScroll.enable(false);\r\n      return;\r\n    }\r\n\r\n    // Fetch Space user by Id\r\n    this.isLoadingUsers = true\r\n    this.spacesProvider.getSpaceUsers(this.spaceId, this.peoplePage, 15)\r\n      .finally(() => {\r\n        if (!infiniteScroll) {\r\n          this.isLoadingUsers = false\r\n        }\r\n        if (infiniteScroll) {\r\n          infiniteScroll.complete();\r\n        }\r\n      })\r\n      .do(response => {\r\n        if (infiniteScroll && !response.ResponseData.length) {\r\n          infiniteScroll.enable(false);\r\n        }\r\n      })\r\n      .subscribe(res => {\r\n        if(res.ResponseData && res.ResponseData.length > 0) {\r\n          this.spaceUsers = this.spaceUsers.concat(res.ResponseData);\r\n        }\r\n        if (res.ResponseData.length < 15 && infiniteScroll) {\r\n          infiniteScroll.enable(false);\r\n        }\r\n      });\r\n  }\r\n\r\n  approve(person: any) {\r\n    const saveloader = this.loadingCtrl.create({\r\n    });      \r\n    saveloader.present();\r\n    this.spacesProvider.setMemberShip(this.spaceId, person.UserID, true)\r\n      .finally(()=>{\r\n        saveloader.dismiss();\r\n      })\r\n      .subscribe(res => {\r\n        if(res.IsError == false && res.ResponseData == true) {          \r\n          this.spaceRequestUsers = this.spaceRequestUsers.filter(v => {\r\n            return v.UserID != person.UserID;\r\n          })\r\n          this.translate.get(\"EXTRA.REQUEST_ACCEPTED\").subscribe(res => {\r\n            this.presentToast(res);\r\n          });\r\n        } else {\r\n          this.translate.get(\"TOAST.ERROR\").subscribe(res => {\r\n            this.presentToast(res);\r\n          });\r\n        }\r\n      })\r\n  }\r\n\r\n  decline(person: any) {\r\n    const saveloader = this.loadingCtrl.create({\r\n    });      \r\n    saveloader.present();\r\n    this.spacesProvider.setMemberShip(this.spaceId, person.UserID, false)\r\n      .finally(()=>{\r\n        saveloader.dismiss();\r\n      })\r\n      .subscribe(res => {\r\n        if(res.IsError == false && res.ResponseData == true) {\r\n          this.spaceRequestUsers = this.spaceRequestUsers.filter(v => {\r\n            return v.UserID != person.UserID;\r\n          })\r\n          this.translate.get(\"EXTRA.REQUEST_REJECTED\").subscribe(res => {\r\n            this.presentToast(res);\r\n          });\r\n        } else {\r\n          this.translate.get(\"TOAST.ERROR\").subscribe(res => {\r\n            this.presentToast(res);\r\n          });\r\n        }\r\n      })\r\n  }\r\n\r\n  private presentToast(msg) {\r\n    let toast = this.toastCtrl.create({\r\n      message: msg,\r\n      duration: 3000,\r\n      position: 'bottom'\r\n    });\r\n    toast.present();\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/spaces/manage-user/manage-user.ts"],"sourceRoot":""}